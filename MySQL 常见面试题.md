# MySQL 常见面试题

## 为什么 `InnoDB` 表必须包含主键，并且推荐使用整型的自增主键？

如果在建表时没有指定某一列作为主键，那么 MySQL 会扫描整表的所有列，直到找到某一列中的数据都不重复，就将该列作为主键索引来维护整表的数据。如果所有列的数据都存在重复的情况，那么 MySQL 会在后台维护一个**隐藏列**来确保唯一性，这样会降低 MySQL 的执行效率。

使用 B+ 树进行索引查找的过程涉及多次**比大小**，字符串比大小的效率要远远低于整型比大小。同时整型数据即使是使用 BIGINT 类型也才占用 8 个字节，而 UUID 最少也要占用几十个字节，浪费 MySQL 的存储空间。之所以使用自增主键，是因为每次调用 INSERT 插入数据时，新插入的数据都会被插在整个棵树最右边的叶子节点中，可以减少平衡 B+ 树的次数。

## 为什么非主键索引的叶子节点存储的是主键值？

## 索引

### InnoDB 聚簇索引

InnoDB 聚簇索引的叶子节点存储行数据，因此 InnoDB 必须要有且只有一个聚集索引。

1. 如果表定义了主键（ Primary Key ），那么主键就是聚簇索引。

2. 如果表没有定义主键，则第一个设置了 NOT NULL UNIQUE 的列就是聚簇索引。

3. 否则 InnoDB 会另外创建一个隐藏的 rowId 作为聚簇索引。

### InnoDB 非聚簇索引

以主键以外的列作为键值构建的 B+ 索引树，称之为非聚簇索引。

### 聚簇索引和非聚簇索引的区别

聚簇索引和非聚簇索引的区别在于，非聚簇索引的叶子节点不存储表中的行数据，而是存储该行对应的主键，想要查找行数据还需要根据主键再去聚集索引中进行查找，这个再根据聚集索引查找行数据的过程称为回表。
